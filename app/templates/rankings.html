{% extends "base.html" %}

{% block title %}ELO Rankings - Cricket Predictor{% endblock %}

{% block content %}
<div class="hero" style="padding: 2rem;">
    <h1>ELO Rankings</h1>
    <p>Current T20 Men's ratings based on historical performance</p>
</div>

<div class="grid grid-3">
    <!-- Team Rankings -->
    <div class="card">
        <h2 class="card-title">Team Rankings</h2>
        <div id="team-rankings">
            <div class="loading"><div class="spinner"></div></div>
        </div>
    </div>
    
    <!-- Batting Rankings -->
    <div class="card">
        <h2 class="card-title">Top Batters</h2>
        <div id="batting-rankings">
            <div class="loading"><div class="spinner"></div></div>
        </div>
    </div>
    
    <!-- Bowling Rankings -->
    <div class="card">
        <h2 class="card-title">Top Bowlers</h2>
        <div id="bowling-rankings">
            <div class="loading"><div class="spinner"></div></div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    async function loadRankings() {
        // Load team rankings
        const teamResponse = await fetch('/api/rankings/teams');
        const teamData = await teamResponse.json();
        
        if (teamData.success) {
            const container = document.getElementById('team-rankings');
            container.innerHTML = teamData.rankings.map((t, i) => `
                <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color);">
                    <div>
                        <span style="color: var(--text-muted); width: 2rem; display: inline-block;">${i + 1}.</span>
                        <span>${t.name}</span>
                    </div>
                    <span style="font-family: 'JetBrains Mono', monospace; color: var(--accent-primary);">
                        ${Math.round(t.elo)}
                    </span>
                </div>
            `).join('');
        }
        
        // Load batting rankings
        const battingResponse = await fetch('/api/rankings/batting');
        const battingData = await battingResponse.json();
        
        if (battingData.success) {
            const container = document.getElementById('batting-rankings');
            container.innerHTML = battingData.rankings.map((p, i) => `
                <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color);">
                    <div>
                        <span style="color: var(--text-muted); width: 2rem; display: inline-block;">${i + 1}.</span>
                        <span>${p.name}</span>
                        <span style="color: var(--text-muted); font-size: 0.75rem;">${p.country || ''}</span>
                    </div>
                    <span style="font-family: 'JetBrains Mono', monospace; color: var(--accent-secondary);">
                        ${Math.round(p.elo)}
                    </span>
                </div>
            `).join('');
        }
        
        // Load bowling rankings
        const bowlingResponse = await fetch('/api/rankings/bowling');
        const bowlingData = await bowlingResponse.json();
        
        if (bowlingData.success) {
            const container = document.getElementById('bowling-rankings');
            container.innerHTML = bowlingData.rankings.map((p, i) => `
                <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color);">
                    <div>
                        <span style="color: var(--text-muted); width: 2rem; display: inline-block;">${i + 1}.</span>
                        <span>${p.name}</span>
                        <span style="color: var(--text-muted); font-size: 0.75rem;">${p.country || ''}</span>
                    </div>
                    <span style="font-family: 'JetBrains Mono', monospace; color: var(--accent-warning);">
                        ${Math.round(p.elo)}
                    </span>
                </div>
            `).join('');
        }
    }
    
    // Load on page ready
    document.addEventListener('DOMContentLoaded', loadRankings);
</script>
{% endblock %}
